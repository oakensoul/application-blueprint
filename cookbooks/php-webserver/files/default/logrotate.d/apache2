/var/log/apache2/*log {
  size 250M
  rotate 5

  create 640 root adm

  dateext
  dateformat -%s

  missingok
  notifempty
  sharedscripts
  compress

  prerotate
    if [ -d /mnt/logs ]
    then
      for file in `/usr/bin/find /var/log/apache2 -name "*.gz"`;
      do
        /bin/mkdir -p /mnt/logs/apache2/`hostname`/`/usr/bin/stat -c %y $file | /usr/bin/awk '{print $1}'`;
        /bin/mv $file /mnt/logs/apache2/`hostname`/`/usr/bin/stat -c %y $file | /usr/bin/awk '{print $1}'`;
      done
    fi
  endscript
  postrotate
    /etc/init.d/apache2 reload > /dev/null
  endscript
}
